---
title: 代码风格
author: Oxyzhg
tags: 代码风格
abbrlink: 1e0ddd5d
date: 2021-01-08 16:34:43
---

> 看完你们项目的源码，就知道你们团队有多少个人。

各种命名风格，各种冗余代码，各种缩进风格，各种奇葩注释和各种没有注释，_眼中有码，心中无码_，只有心累两个字。项目的整洁度会受到很多客观因素的影响，为了自己的身心健康，我们应该试图将这种影响降到最低。简单地说，统一格式和风格的代码让人更加赏心悦目，更不容易让你产生想摔键盘的冲动。说的更有 B 格，叫做**熵减**，也就是降低团队产出代码的无序性，如果你想在未来成为一名合格的前端架构师，这将是你的工作目标。

## 代码风格

代码风格通常体现在编辑器行为上，我们通过 editorconfig 跨编辑器约束。

在项目的根目录创建 _.editorconfig_ 文件，文件内容如下：

```yml
root = true                      # 表明是最顶层的配置文件

[*]                              # 正则*匹配所有文件
charset = utf-8                  # 编码格式
end_of_line = lf                 # 定义换行符
indent_style = space             # 缩进方式
indent_size = 2                  # 缩进空格数
trim_trailing_whitespace = true  # 是否去处行首行尾的空白字符
insert_final_newline = true      # 文件是否以空白行结尾

[*.md]                           # 正则匹配以.md结尾的文件
trim_trailing_whitespace = false
```

- 文本换行方式使用 LF
- 代码缩进使用 2 个空格，不使用 Tab
- 所有文件最后留一行空行

## 命名

由历史原因及个人习惯引起的 DOM 结构、命名不统一，导致不同成员在维护同一页面时，效率低下，迭代、维护成本极高。

前端常见的命名方式：**kebab-case**、**Pascal**、**camelCase**、**snake_case**、大写命名等。

### 目录命名

- 通常采用 **kebab-case** 方式命名（这是业内最常见的目录命名方式）
- 对于组件文件来说，命名方式有两种：
  - 在 React 项目中，推荐使用 **Pascal** 方式命名
  - 在 Vue 项目中，推荐使用 **kebab-case** 方式命名，官方推荐
- 此外也可使用 **camelCase** 方式命名，这种命名方式在一些类库中常见，通常是导入导出某个方法等
- 不管采用哪种命名方式，在项目中同类型目录/文件命名尽可能保持一致
- 禁止采用上述命名方式以外的命名方法，更不能糅合多种命名方式
- 有复数结构时，要采用复数命名法

### 变量命名

- 普通变量采用 **camelCase** 方式命名
- 对于构造函数，统一采用 **Pascal** 方式命名，普通函数仍采用 **camelCase** 方式命名
- 特殊场景下允许使用 **snake_case** 方式命名，常见于解构赋值
- 命名尽可能语义化，尽量不要模糊命名
- 推荐命名规则
  - 类名/属性名/变量名一般是名词，或是形容词+名词
  - 方法一般是动词，或是动词+名词
- 禁止糅合多种命名方式

## 组件开发

- 组件文件名应与组件名保持一致
- 如果组件文件命名为 `index.(js|jsx|ts|tsx|vue)`，那么主文件夹名称应与组件名称一致
- 组件名称/组件文件名称应尽可能语义化，体现组件存在的意义
- 一个文件仅包含一个组件
- 某个组件的样式文件，应与组件文件名保持一致
- 在功能设计之初，应对组件进行合理拆分，保证组件文件代码量不能太长
- 合理区别业务组件还是通用组件，如果是通用组件更应考虑多场景适用性
- 对于组件用到较多的常量，或常量是多文件共享，应提取成单文件
- 对于多组件/文件频繁使用的逻辑，应以纯函数的形式提取成单文件
- 以 `handle` 开头的事件处理方法，如 `handleClick`
- 以 `on` 开头的事件处理方法，如 `onFormSubmit`，建议用 `handle`

## 状态管理

- 始终坚持单向数据流和单一数据源的原则
- 状态不要通过 props 多层传递，如需经过多层传递，建议使用 vuex 或状态管理库
- 不一定所有的数据处理都使用 vuex，对于特定场景的数据应存在组件状态中，并写明备注

## 样式

- 不建议使用行内样式
- 不建议直接在 JSX 文件中导入 CSS 文件
- 建议使用 CSS Modules 或 CSS in JS 方案

## 注释

注释的原则：`as short as possible, as long as necessary.`

- 每个类/构造函数的定义都应附带注释，描述类的功能和用法，除非它的功能相当明显
- 关键纯函数/公共函数的定义应附带注释
- 关键变量/常量应附带注释
- 复杂代码逻辑应附带注释
- 特殊标记注释：如 `TODO` , `FIXME` 等有特殊含义的标记
- 文件注释不做要求，除非有必要

相关资料：[JSDoc 文档](https://jsdoc.app/)

## 其他
