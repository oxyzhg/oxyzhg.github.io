<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/fex/blog/rss.xml" title="FEX Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fex/blog/atom.xml" title="FEX Blog Atom Feed"><title data-react-helmet="true">概览 | FEX</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="概览 | FEX"><meta data-react-helmet="true" name="description" content="性能是前端领域关注度非常高的话题，因为页面性能的好坏会直接影响用户体验。为了不断提升用户体验，前端工程师往往会对页面性能不断改进，而这个改进的过程就叫性能优化。"><meta data-react-helmet="true" property="og:description" content="性能是前端领域关注度非常高的话题，因为页面性能的好坏会直接影响用户体验。为了不断提升用户体验，前端工程师往往会对页面性能不断改进，而这个改进的过程就叫性能优化。"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/fex/docs/performance"><link data-react-helmet="true" rel="shortcut icon" href="/fex/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/fex/docs/performance"><link rel="stylesheet" href="/fex/styles.861f1fa8.css">
<link rel="preload" href="/fex/styles.9fdd6ab1.js" as="script">
<link rel="preload" href="/fex/runtime~main.15be3d75.js" as="script">
<link rel="preload" href="/fex/main.089dac64.js" as="script">
<link rel="preload" href="/fex/1.eab185d5.js" as="script">
<link rel="preload" href="/fex/2.e4dda417.js" as="script">
<link rel="preload" href="/fex/78.39609ce8.js" as="script">
<link rel="preload" href="/fex/79.bf84be31.js" as="script">
<link rel="preload" href="/fex/935f2afb.4b0c4498.js" as="script">
<link rel="preload" href="/fex/17896441.4bdbfa24.js" as="script">
<link rel="preload" href="/fex/cd86a722.ecaa5662.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/fex/"><img src="/fex/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/fex/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">FEX</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/fex/docs/advanced">前端进阶</a><a class="navbar__item navbar__link" href="/fex/docs/engineering">工程化</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fex/docs/performance">性能优化</a><a href="https://github.com/oxyzhg/fex" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/fex/"><img src="/fex/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/fex/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">FEX</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/fex/docs/advanced">前端进阶</a></li><li class="menu__list-item"><a class="menu__link" href="/fex/docs/engineering">工程化</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/fex/docs/performance">性能优化</a></li><li class="menu__list-item"><a href="https://github.com/oxyzhg/fex" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/fex/docs/performance">概览</a></li><li class="menu__list-item"><a class="menu__link" href="/fex/docs/engineering/webpack/optimization-analysis">Webpack 构建优化分析</a></li><li class="menu__list-item"><a class="menu__link" href="/fex/docs/performance/vue">Vue 项目性能优化实践</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">概览</h1></header><div class="markdown"><p>性能是前端领域关注度非常高的话题，因为页面性能的好坏会直接影响用户体验。为了不断提升用户体验，前端工程师往往会对页面性能不断改进，而这个改进的过程就叫性能优化。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="性能指标"></a>性能指标<a class="hash-link" href="#性能指标" title="Direct link to heading">#</a></h2><p>性能是指程序的运行速度，而前端性能是指页面的响应速度，提到速度必然离不开一个变量，那就是时间。所以我们会看到性能指标都是以时间为单位来测量的。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="首屏绘制-first-paint-fp"></a>首屏绘制 (First Paint, FP)<a class="hash-link" href="#首屏绘制-first-paint-fp" title="Direct link to heading">#</a></h3><p>首屏绘制时间，指从开始加载到浏览器首次绘制像素到屏幕上的时间，也就是页面在屏幕上首次发生视觉变化的时间。注意首屏绘制不包括默认的背景绘制，但包括非默认的背景绘制。由于首次绘制之前网页呈现默认背景白色，所以也称白屏时间。</p><p>获取到这个指标值也非常简单，在 HTML5 下可以通过 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Performance" target="_blank" rel="noopener noreferrer">Performance API</a> 来获取，具体代码如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token dom variable" style="color:rgb(156, 220, 254)">performance</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">getEntriesByName</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;first-paint&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// [</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">//   {</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">//     duration: 0,                  // 该事件的耗时</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">//     entryType: &#x27;paint&#x27;,           // 性能指标实例的类型</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">//     name: &#x27;first-paint&#x27;,          // 性能指标名称</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">//     startTime: 225.8849999998347, // 性能指标开始采集时间</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">//   },</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// ];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>返回一个 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceEntry" target="_blank" rel="noopener noreferrer">PerformanceEntry</a> 对象的列表。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="首屏内容绘制-first-contentful-paint-fcp"></a>首屏内容绘制 (First Contentful Paint, FCP)<a class="hash-link" href="#首屏内容绘制-first-contentful-paint-fcp" title="Direct link to heading">#</a></h3><p>首屏内容绘制时间，指浏览器首次绘制来自 DOM 的内容时间，这个内容可以是文字、图片、非空白的 canvas 和 svg。</p><p>获取这个指标的具体代码如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token dom variable" style="color:rgb(156, 220, 254)">performance</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">getEntriesByName</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;first-contentful-paint&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>FCP 有时候会和 FP 时间相同，也可能晚于 FP。因为 FP 只需要满足<strong>开始绘制</strong>这一个条件即可，而 FCP 还要满足第二个条件，那就是<strong>绘制的像素有内容</strong>。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="可交互时间-time-to-interactive-tti"></a>可交互时间 (Time to Interactive, TTI)<a class="hash-link" href="#可交互时间-time-to-interactive-tti" title="Direct link to heading">#</a></h3><p>可交互时间，指网页在视觉上都已渲染出了，浏览器可以响应用户的操作了。虽然理解起来比较简单，但实际测量起来要考虑两个条件：第一个条件是主线程的长任务（长任务是指耗时超过 50ms）执行完成后，第二个条件是随后网络静默时间达到 5s，这里的静默时间是指请求数不超过 2 个，排除失败的资源请求和未使用 GET 方法进行的网络请求。</p><p>TTI 测量可以使用 Google 提供的模块 <a href="https://www.npmjs.com/package/tti-polyfill" target="_blank" rel="noopener noreferrer">tti-polyfill</a>，示例代码如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports">ttiPolyfill</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;tti-polyfill&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ttiPolyfill</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">getFirstConsistentlyInteractive</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">opts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">tti</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Use `tti` value in some way.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="总阻塞时间-total-blocking-time-tbt"></a>总阻塞时间 (Total Blocking Time, TBT)<a class="hash-link" href="#总阻塞时间-total-blocking-time-tbt" title="Direct link to heading">#</a></h3><p>总阻塞时间，指阻塞用户响应（比如键盘输入、鼠标点击）的所有时间。指标值是将 FCP 之后一直到 TTI 这段时间内的阻塞部分时间总和，阻塞部分是指长任务执行时间减去 50ms。</p><p>获取长任务耗时的方式如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">var</span><span class="token plain"> observer </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">PerformanceObserver</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token keyword" style="color:#e3116c">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">var</span><span class="token plain"> perfEntries </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> list</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">getEntries</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> perfEntrie </span><span class="token keyword" style="color:#e3116c">of</span><span class="token plain"> perfEntries</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">perfEntrie</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toJSON</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// {</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//   attribution: [TaskAttributionTiming],</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//   duration: 6047.770000004675,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//   entryType: &#x27;longtask&#x27;,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//   name: &#x27;self&#x27;,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//   startTime: 22.444999995059334,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// };</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">observer</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">observe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">  entryTypes</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&#x27;longtask&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>首先通过 <code>PerformanceObserver</code> 函数构造一个性能监测实例，通过回调函数参数的 <code>getEntries()</code> 方法来获取 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceEntry" target="_blank" rel="noopener noreferrer">PerformanceEntry</a> 实例数组，每个实例对应一个长任务。然后要指定监测实例的实体类型为 <code>longtask</code>，之后页面执行操作就可以获取长任务实例。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="最大内容绘制-largest-contentful-paint-lcp"></a>最大内容绘制 (Largest Contentful Paint, LCP)<a class="hash-link" href="#最大内容绘制-largest-contentful-paint-lcp" title="Direct link to heading">#</a></h3><p>最大内容绘画，指视口内可见的最大图像或文本块的绘制时间。测量这个指标的值和 TBT 相似，不同的是将实体类型设为<code>largest-contentful-paint</code>。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="统计方式"></a>统计方式<a class="hash-link" href="#统计方式" title="Direct link to heading">#</a></h2><p>虽然我们可以通过一些方式来精确地采集性能指标，但不同的用户、不同的环境采集同一指标值会有所差异。所以通常需要对大量采集的性能指标数据进行统计才能用来量化。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="平均值统计"></a>平均值统计<a class="hash-link" href="#平均值统计" title="Direct link to heading">#</a></h3><p>平均值统计应该是大家最容易想到的统计方法，将所有用户产生的性能指标值收集起来，然后对这些数据取平均值，最终得到平均耗时数据。这种统计方式最大的问题就是容易受极值影响。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="百位数统计"></a>百位数统计<a class="hash-link" href="#百位数统计" title="Direct link to heading">#</a></h3><p>百分位数统计可以解决极值问题。百分位数是对应于百分位的实际数值，比如第 70 百分位数：将数据从小到大排列，处于第 70% 的数据称为 70 分位数，表示 70% 的性能数据均小于等于该值，那剩下的 30% 的数据均大于等于该值了。</p><p>百分位数的好处在于，对于性能需求不同的页面或应用，可以设置不同的百分位数。对性能要求越高，使用越大的百分位数。</p><p>比如在追求极致性能的情况下，要求 99% 的用户都要小于 3 秒，我们看页面加载时长时候就应该看 99 分位数。而某些重要程度比较低的页面，可以只要求 50% 的用户页面加载时长小于 3 秒，那么对应的就是 50 分位数，也称中位数。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="优化思路"></a>优化思路<a class="hash-link" href="#优化思路" title="Direct link to heading">#</a></h2><p>有了性能指标和统计方式之后，就可以正式开始针对不同的指标值进行优化了。前端性能优化一般可以从两个方向入手：<strong>加载性能优化</strong>和<strong>渲染性能优化</strong>。</p><p>虽然不同方向的优化手段不同，但大体上都遵循两个思路：<strong>做减法</strong>和<strong>做除法</strong>。做减法是直接减少耗时操作或资源体积，做除法是在耗时操作和资源体积无法减少的情况下，对其进行拆分处理或者对不可拆分的内容进行顺序调换。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="加载性能优化"></a>加载性能优化<a class="hash-link" href="#加载性能优化" title="Direct link to heading">#</a></h3><p>做减法的有：</p><ul><li><strong>采用 gzip 压缩</strong>，典型的减少资源的传输体积；</li><li><strong>使用缓存</strong>，强制缓存可以减少浏览器请求次数，而协商缓存可以减少传输体积；</li><li>使用雪碧图，减少浏览器请求次数。</li></ul><p>做除法的有：</p><ul><li>HTTP/2 多路复用，把多个请求拆分成二进制帧，并发传输；</li><li>懒加载，将 Web 应用拆分成不同的模块或文件，按需加载；</li><li>把 script 标签放到 body 底部，通过调整顺序来控制渲染时间。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="渲染性能优化"></a>渲染性能优化<a class="hash-link" href="#渲染性能优化" title="Direct link to heading">#</a></h3><p>做减法的有：</p><ul><li>避免重排与重绘，减少渲染引擎的绘制；</li><li>防抖操作，减少函数调用或请求次数；</li><li>减少 DOM 操作，减少渲染引擎和脚本引擎的切换，同时也减少渲染引擎绘制。</li></ul><p>做除法的有：</p><ul><li>骨架屏，将页面内容进行拆分，调整不同部分的显示顺序；</li><li>使用 Web Worker，将一些长任务拆分出来，放到 Web Worker 中执行；</li><li>React Fiber，将同步视图的任务进行拆分，可调换顺序，可暂停。</li></ul><p>在不同的方向上，对不同步骤，<strong>优先考虑做减法，然后再考虑做除法</strong>。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="总结"></a>总结<a class="hash-link" href="#总结" title="Direct link to heading">#</a></h2><p>前端性能优化实际上包括两个步骤，即<strong>量化</strong>和<strong>优化</strong>。</p><p>在量化过程中，先采集特定的指标，比较重要的指标有：首屏绘制、首屏内容绘制、可交互时间、总阻塞时间、最大内容绘制；然后对不同用户产生的指标值进行统计，这里推荐使用百分位数统计法，对于不同性能需求的页面设置不同的百分位数。</p><p>在优化过程中，要根据性能指标统计结果进行优化，可通过做减法和做除法的思路分别对加载性能和渲染性能进行优化。在不同的方向上，对不同步骤，优先考虑做减法，然后再考虑做除法。</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/oxyzhg/fex/edit/main/docs/performance/index.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/fex/docs/engineering/webpack/optimization-analysis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Webpack 构建优化分析 »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#性能指标" class="table-of-contents__link">性能指标</a><ul><li><a href="#首屏绘制-first-paint-fp" class="table-of-contents__link">首屏绘制 (First Paint, FP)</a></li><li><a href="#首屏内容绘制-first-contentful-paint-fcp" class="table-of-contents__link">首屏内容绘制 (First Contentful Paint, FCP)</a></li><li><a href="#可交互时间-time-to-interactive-tti" class="table-of-contents__link">可交互时间 (Time to Interactive, TTI)</a></li><li><a href="#总阻塞时间-total-blocking-time-tbt" class="table-of-contents__link">总阻塞时间 (Total Blocking Time, TBT)</a></li><li><a href="#最大内容绘制-largest-contentful-paint-lcp" class="table-of-contents__link">最大内容绘制 (Largest Contentful Paint, LCP)</a></li></ul></li><li><a href="#统计方式" class="table-of-contents__link">统计方式</a><ul><li><a href="#平均值统计" class="table-of-contents__link">平均值统计</a></li><li><a href="#百位数统计" class="table-of-contents__link">百位数统计</a></li></ul></li><li><a href="#优化思路" class="table-of-contents__link">优化思路</a><ul><li><a href="#加载性能优化" class="table-of-contents__link">加载性能优化</a></li><li><a href="#渲染性能优化" class="table-of-contents__link">渲染性能优化</a></li></ul></li><li><a href="#总结" class="table-of-contents__link">总结</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/fex/docs/advanced">前端进阶</a></li><li class="footer__item"><a class="footer__link-item" href="/fex/docs/engineering">前端工程化</a></li><li class="footer__item"><a class="footer__link-item" href="/fex/docs/algorithms">数据结构与算法</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://juejin.cn/user/571401775099528" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金</a></li><li class="footer__item"><a href="https://www.yuque.com/oxyzhg" target="_blank" rel="noopener noreferrer" class="footer__link-item">语雀</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/oxyzhg" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2021 Oxyzhg</div></div></div></footer></div>
<script src="/fex/styles.9fdd6ab1.js"></script>
<script src="/fex/runtime~main.15be3d75.js"></script>
<script src="/fex/main.089dac64.js"></script>
<script src="/fex/1.eab185d5.js"></script>
<script src="/fex/2.e4dda417.js"></script>
<script src="/fex/78.39609ce8.js"></script>
<script src="/fex/79.bf84be31.js"></script>
<script src="/fex/935f2afb.4b0c4498.js"></script>
<script src="/fex/17896441.4bdbfa24.js"></script>
<script src="/fex/cd86a722.ecaa5662.js"></script>
</body>
</html>