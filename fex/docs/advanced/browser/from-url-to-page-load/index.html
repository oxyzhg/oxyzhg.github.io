<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/fex/blog/rss.xml" title="FEX Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fex/blog/atom.xml" title="FEX Blog Atom Feed"><title data-react-helmet="true">从输入URL到页面加载过程 | FEX</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="从输入URL到页面加载过程 | FEX"><meta data-react-helmet="true" name="description" content="这是一个综合性非常强的问题，可能会在某个点上深挖出非常多的细节，出这个题目的目的就是为了考察你的 web 基础深入到什么程度。学习是一个循序渐进的过程，先明白整体流程再去研究细节，这会对整个知识体系有更深的理解。"><meta data-react-helmet="true" property="og:description" content="这是一个综合性非常强的问题，可能会在某个点上深挖出非常多的细节，出这个题目的目的就是为了考察你的 web 基础深入到什么程度。学习是一个循序渐进的过程，先明白整体流程再去研究细节，这会对整个知识体系有更深的理解。"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/fex/docs/advanced/browser/from-url-to-page-load"><link data-react-helmet="true" rel="shortcut icon" href="/fex/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/fex/docs/advanced/browser/from-url-to-page-load"><link rel="stylesheet" href="/fex/styles.861f1fa8.css">
<link rel="preload" href="/fex/styles.9c17d1f3.js" as="script">
<link rel="preload" href="/fex/runtime~main.f4a5e530.js" as="script">
<link rel="preload" href="/fex/main.f2bc5511.js" as="script">
<link rel="preload" href="/fex/1.98595dda.js" as="script">
<link rel="preload" href="/fex/2.0901b864.js" as="script">
<link rel="preload" href="/fex/73.9ebeebc2.js" as="script">
<link rel="preload" href="/fex/74.58203a54.js" as="script">
<link rel="preload" href="/fex/935f2afb.65002741.js" as="script">
<link rel="preload" href="/fex/17896441.c03a6b1c.js" as="script">
<link rel="preload" href="/fex/fe7df52f.1deac101.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/fex/"><img src="/fex/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/fex/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">FEX</strong></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fex/docs/advanced">前端进阶</a><a class="navbar__item navbar__link" href="/fex/docs/engineering">工程化</a><a class="navbar__item navbar__link" href="/fex/docs/performance">性能优化</a><a href="https://github.com/oxyzhg/fex" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/fex/"><img src="/fex/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/fex/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">FEX</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/fex/docs/advanced">前端进阶</a></li><li class="menu__list-item"><a class="menu__link" href="/fex/docs/engineering">工程化</a></li><li class="menu__list-item"><a class="menu__link" href="/fex/docs/performance">性能优化</a></li><li class="menu__list-item"><a href="https://github.com/oxyzhg/fex" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/fex/docs/advanced">概览</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">JavaScript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/javascript/inheritance">继承</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/javascript/eventloop">事件循环</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Vue.js</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue">概览</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/data-driven">数据驱动</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/componentization">组件化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/reactive">响应式原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/compile">编译</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/lifecycle">生命周期</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/next-tick">nextTick</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/computed-vs-watch">计算属性 vs 侦听属性</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/component-update">组件更新</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/v-model">v-model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/vue/mvvm">MVVM</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">浏览器</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/fex/docs/advanced/browser/from-url-to-page-load">从输入URL到页面加载过程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fex/docs/advanced/browser/browser-storage">浏览器存储</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fex/docs/advanced/browser/browser-cache">浏览器缓存</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fex/docs/advanced/browser/browser-gc">垃圾回收</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fex/docs/advanced/browser/cross-origin">跨域</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">安全</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/security">概览</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/security/xss">XSS 攻击</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/security/csrf">CSRF 攻击</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/network/http">HTTP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fex/docs/advanced/network/websocket">WebSocket</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">从输入URL到页面加载过程</h1></header><div class="markdown"><p>这是一个综合性非常强的问题，可能会在某个点上深挖出非常多的细节，出这个题目的目的就是为了考察你的 web 基础深入到什么程度。学习是一个循序渐进的过程，先明白整体流程再去研究细节，这会对整个知识体系有更深的理解。</p><p>总体来说分为以下几个过程：</p><ol><li>DNS 解析</li><li>TCP 连接</li><li>发送 HTTP 请求</li><li>服务端处理请求并返回 HTTP 报文</li><li>客户端解析并渲染页面</li><li>断开连接</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-dns-解析"></a>1. DNS 解析<a class="hash-link" href="#1-dns-解析" title="Direct link to heading">#</a></h2><p>在浏览器输入网址后，首先要经过域名解析，因为浏览器并不能直接通过域名找到对应的服务器，而是要通过 IP 地址。互联网上每一台计算机的唯一标识是它的 IP 地址，但是 IP 地址并不方便记忆，用户更喜欢用方便记忆的网址去寻找互联网上的其它计算机，所以互联网设计者需要在用户的方便性与可用性方面做一个权衡，这个权衡就是一个网址到 IP 地址的转换，这个过程就是 DNS 解析。它实际上充当了一个翻译的角色，<strong>实现了网址到 IP 地址的转换</strong>，此时 DNS 服务应运而生。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="dns-解析过程"></a>DNS 解析过程<a class="hash-link" href="#dns-解析过程" title="Direct link to heading">#</a></h3><p>DNS 解析是一个迭代查询+递归查询的过程，具体步骤如下图：</p><p><img alt="DNS" src="/fex/assets/images/dns-resolve-7957b7730b51feb94db7081eb8c3a155.jpg"></p><p>上述图片是查找 <a href="http://www.kaola.com" target="_blank" rel="noopener noreferrer">www.kaola.com</a> 的 IP 地址过程。首先在本地域名服务器中查询 IP 地址，如果没有找到的情况下，本地域名服务器会向根域名服务器发送一个请求，如果根域名服务器也不存在该域名时，本地域名会向 com 顶级域名服务器发送一个请求，依次类推下去。直到最后本地域名服务器得到 google 的 IP 地址并把它缓存到本地，供下次查询使用。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="dns-优化"></a>DNS 优化<a class="hash-link" href="#dns-优化" title="Direct link to heading">#</a></h3><ol><li><strong>DNS 缓存</strong>：浏览器缓存，系统缓存，路由器缓存，IPS 服务器缓存，根域名服务器缓存，顶级域名服务器缓存，主域名服务器缓存。通过缓存直接读取域名相对应的 ip，减去了繁琐的查找 IP 的步骤，大大加快访问速度。</li><li><strong>DNS 负载均衡</strong>：使用 CDN 进行负载均衡，利用 DNS 的重定向技术，同步服务器运行情况，然后根据该情况及时适当调整调度策略，从而使得负载均衡能力大大提高。</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="dns-负载均衡"></a>DNS 负载均衡<a class="hash-link" href="#dns-负载均衡" title="Direct link to heading">#</a></h3><p>不知道大家有没有思考过一个问题：DNS 返回的 IP 地址是否每次都一样？如果每次都一样是否说明你请求的资源都位于同一台机器上面，那么这台机器需要多高的性能和储存才能满足亿万请求呢？其实真实的互联网世界背后存在成千上百台服务器，大型的网站甚至更多。但是在用户的眼中，它需要的只是处理他的请求，哪台机器处理请求并不重要。DNS 可以返回一个合适的机器的 IP 给用户，例如可以根据每台机器的负载量，该机器离用户地理位置的距离等等，这种过程就是 DNS 负载均衡，又叫做 DNS 重定向。大家耳熟能详的 CDN(Content Delivery Network) 就是利用 DNS 的重定向技术，DNS 服务器会返回一个跟用户最接近的点的 IP 地址给用户，CDN 节点的服务器负责响应用户的请求，提供所需的内容。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2-tcp-连接"></a>2. TCP 连接<a class="hash-link" href="#2-tcp-连接" title="Direct link to heading">#</a></h2><p>TCP（Transmission Control Protocol，传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="三次握手"></a>三次握手<a class="hash-link" href="#三次握手" title="Direct link to heading">#</a></h3><ol><li>客户端发送一个带 <code>SYN=1,Seq=x</code> 的数据包到服务端，并进入 <code>SYN_SEND</code>状态，等待服务器确认。</li><li>服务端发回一个带 <code>SYN=1,ACK=x+1,Seq=y</code> 的数据包到客户端，以示传达确认信息，并进入 <code>SYN_RECV</code> 状态。</li><li>客户端再回传一个带 <code>ACK=y+1,Seq=z</code> 的数据包到服务端，包发送完毕后，客户端与服务端都进入 <code>ESTABLISHED</code> 状态。完成 TCP 三次握手。</li></ol><p>建立 TCP 连接经历下面的三个阶段：</p><ol><li>建立连接。通过三次握手（即总共发送 3 个数据包确认已经建立连接）建立客户端和服务器之间的连接。</li><li>进行数据传输。这里有一个重要的数据包校验机制，就是接收方接收到数据包后必须要向发送方确认, 如果发送方没有接到这个确认的消息，就判定为数据包丢失，并重发该数据包。当然，发送的过程中还有一个优化策略，就是把大的数据包拆成多个小包，依次传输到接收方，接收方按照这个小包的顺序把它们组装成完整数据包。</li><li>断开连接的阶段。数据传输完成，现在要断开连接了，通过四次挥手来断开连接。</li></ol><p>到这里，你应该明白 TCP 连接通过什么手段来保证数据传输的可靠性：一是通过<strong>三次握手</strong>确认连接，二是<strong>数据包校验</strong>保证数据到达接收方，三是通过<strong>四次挥手</strong>断开连接。</p><p>当然，如果再深入地问，比如为什么要三次握手，两次不行吗？第三次握手失败了怎么办？为什么要四次挥手等等这一系列的问题，涉及计算机网络的基础知识，比较底层，但是也是非常重要的细节，<a href="https://zhuanlan.zhihu.com/p/86426969" target="_blank" rel="noopener noreferrer">参考资料</a>。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="3-发送-http-请求"></a>3. 发送 HTTP 请求<a class="hash-link" href="#3-发送-http-请求" title="Direct link to heading">#</a></h2><p>实这部分又可以称为前端工程师眼中的 HTTP，它主要发生在客户端。发送 HTTP 请求的过程就是构建 HTTP 请求报文并通过 TCP 协议中发送到服务器指定端口(HTTP 协议 80/8080, HTTPS 协议 443)。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="请求报文"></a>请求报文<a class="hash-link" href="#请求报文" title="Direct link to heading">#</a></h3><p>请求报文是由 4 部分组成：<strong>请求行</strong>、<strong>请求报头</strong>、<strong>空行</strong>、<strong>请求包体</strong>。</p><p><img alt="HTTP Request" src="/fex/assets/images/http-request-1a2a85b87a277d5515975ad1fa00dbc2.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="请求行"></a>请求行<a class="hash-link" href="#请求行" title="Direct link to heading">#</a></h3><p>请求行由<strong>请求方法、URI 、HTTP 协议版本</strong> 3 个部分组成，它们之间使用空格隔开。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-plain codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">GET /users HTTP/1.1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>常见的请求方法有：GET、POST、PUT、PATCH、DELETE、HEAD、OPTIONS 等</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="请求头部"></a>请求头部<a class="hash-link" href="#请求头部" title="Direct link to heading">#</a></h3><p>请求头部为请求报文添加了一些附加信息，由 “键/值” 对组成，每行一对，名和值之间使用冒号分隔。请求头部通知服务器有关于客户端请求的信息，典型的请求头属性有：</p><table><thead><tr><th>请求头</th><th>含义</th></tr></thead><tbody><tr><td>Accept</td><td>客户端可识别的响应内容类型列表</td></tr><tr><td>Accept-Encoding</td><td>客户端可接受的编码压缩格式</td></tr><tr><td>Accept-Language</td><td>客户端可接受的自然语言</td></tr><tr><td>Accept-Charset</td><td>可接受的应答的字符集</td></tr><tr><td>Cache-Control</td><td>设置客户端缓存方案</td></tr><tr><td>Connection</td><td>连接方式 (close/keep-alive)</td></tr><tr><td>Cookie</td><td>存储于客户端扩展字段，向同一域名的服务端发送属于该域的 cookie</td></tr><tr><td>Host</td><td>请求的主机名，允许多个域名同处一个 IP 地址，即虚拟主机</td></tr><tr><td>User-Agent</td><td>请求的浏览器类型</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="请求包体"></a>请求包体<a class="hash-link" href="#请求包体" title="Direct link to heading">#</a></h3><p>请求包体不在 GET 方法中使用，而在 POST 方法中使用，该方法适用于表单提交场景。与请求包体相关的最常使用的是包体类型 Content-Type 和包体长度 Content-Length。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="4服务端处理请求并返回-http-报文"></a>4.服务端处理请求并返回 HTTP 报文<a class="hash-link" href="#4服务端处理请求并返回-http-报文" title="Direct link to heading">#</a></h2><p>这部分对应的就是后端工程师眼中的 HTTP。后端从在固定的端口接收到 TCP 报文开始，这部分对应于编程语言中的 Socket。它会对 TCP 连接进行处理，对 HTTP 协议进行解析，并按照报文格式进一步封装成 HTTP Request 对象，供上层使用。这部分工作一般是由 Web 服务器去进行。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="响应报文"></a>响应报文<a class="hash-link" href="#响应报文" title="Direct link to heading">#</a></h3><p>HTTP 响应报文也是由三部分组成：<strong>响应行</strong>、<strong>响应报头</strong>和<strong>响应报文</strong>。</p><p><img alt="HTTP Response" src="/fex/assets/images/http-response-fb3242352f9bafc02ba09fbda5aa6beb.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="响应行"></a>响应行<a class="hash-link" href="#响应行" title="Direct link to heading">#</a></h3><p>状态行由 <strong>HTTP 协议版本</strong>、<strong>状态码</strong>和<strong>状态码描述文本</strong> 3 个部分组成，它们之间使用空格隔开。</p><p>状态码由 3 位数字组成，其中第 1 位数字表示响应的类型，常用的状态码有五大类如下所示：</p><table><thead><tr><th>状态码</th><th>含义</th></tr></thead><tbody><tr><td>1xx</td><td>表示服务器已接收了客户端请求，客户端可继续发送请求</td></tr><tr><td>2xx</td><td>表示服务器已成功接收到请求并进行处理</td></tr><tr><td>3xx</td><td>表示服务器要求客户端重定向</td></tr><tr><td>4xx</td><td>表示客户端的请求有非法内容</td></tr><tr><td>5xx</td><td>表示服务器未能正常处理客户端的请求而出现意外错误</td></tr></tbody></table><p>常见的状态码有：200, 301, 302, 304, 400, 401, 403, 404, 422, 500, 502, 503 等。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="5客户端解析并渲染页面"></a>5.客户端解析并渲染页面<a class="hash-link" href="#5客户端解析并渲染页面" title="Direct link to heading">#</a></h2><p>客户端拿到服务端返回的响应报文，进行数据解析并渲染页面。</p><p><img alt="Page Rander" src="/fex/assets/images/page-rander-f09e1b394587f37804762b83836a72f1.png"></p><p>浏览器解析渲染页面分为以下几个步骤：</p><ol><li>根据 HTML 解析出 DOM 树</li><li>根据 CSS 解析生成 CSS 规则树</li><li>结合 DOM 树和 CSS 规则树，生成渲染树</li><li>根据渲染树计算每一个节点的信息</li><li>根据计算好的信息绘制页面</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="根据-html-解析生成-dom-树"></a>根据 HTML 解析生成 DOM 树<a class="hash-link" href="#根据-html-解析生成-dom-树" title="Direct link to heading">#</a></h3><ul><li>根据 HTML 的内容，将标签按照结构解析成为 DOM 树，DOM 树解析的过程是一个深度优先遍历。即先构建当前节点的所有子节点，再构建下一个兄弟节点。</li><li>在读取 HTML 文档，构建 DOM 树的过程中，若遇到 <code>script</code> 标签，则 DOM 树的构建会暂停，直至脚本执行完毕。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="根据-css-解析生成-css-规则树"></a>根据 CSS 解析生成 CSS 规则树<a class="hash-link" href="#根据-css-解析生成-css-规则树" title="Direct link to heading">#</a></h3><ul><li>解析 CSS 规则树时 JavaScript 执行将暂停，直至 CSS 规则树就绪。</li><li>浏览器在 CSS 规则树生成之前不会进行渲染。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="生成渲染树"></a>生成渲染树<a class="hash-link" href="#生成渲染树" title="Direct link to heading">#</a></h3><ul><li>DOM 树和 CSS 规则树全部准备好了以后，浏览器才会开始构建渲染树。</li><li>精简 CSS 并可以加快 CSS 规则树的构建，从而加快页面相应速度。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="根据渲染树计算每一个节点的信息（布局）"></a>根据渲染树计算每一个节点的信息（布局）<a class="hash-link" href="#根据渲染树计算每一个节点的信息（布局）" title="Direct link to heading">#</a></h3><ul><li>布局：通过渲染树中渲染对象的信息，计算出每一个渲染对象的位置和尺寸。</li><li>回流：在布局完成后，发现了某个部分发生了变化影响了布局，那就需要倒回去重新渲染。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="根据计算好的信息绘制页面"></a>根据计算好的信息绘制页面<a class="hash-link" href="#根据计算好的信息绘制页面" title="Direct link to heading">#</a></h3><ul><li>绘制阶段，系统会遍历呈现树，并调用呈现器的 paint 方法，将呈现器的内容显示在屏幕上。</li><li>重绘：某个元素的背景颜色，文字颜色等，不影响元素周围或内部布局的属性，将只会引起浏览器的重绘。</li><li>回流：某个元素的尺寸发生了变化，则需重新计算渲染树，重新渲染。</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="6-断开连接"></a>6. 断开连接<a class="hash-link" href="#6-断开连接" title="Direct link to heading">#</a></h2><p>当数据传送完毕，需要断开 tcp 连接，此时发起 tcp 四次挥手。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="四次挥手"></a>四次挥手<a class="hash-link" href="#四次挥手" title="Direct link to heading">#</a></h3><ol><li>客户端发送一个带 <code>FIN,ACK,Seq</code> 的数据包到服务端，表示没有已经没有数据传输了，并进入 <code>FIN_WAIT_1</code> 状态。</li><li>服务端发回一个带 <code>ACK, Seq</code> 的数据包到客户端，表示同意关闭请求，服务端发送数据包后进入 <code>CLOSE_WAIT</code> 状态，客户端收到回传的数据包后进入 <code>FIN_WAIT_2</code> 状态。</li><li>服务端全部数据发送完毕后，发送一个带 <code>FIN,ACK,Seq</code> 的数据包到客户端，请求关闭连接，并进入 <code>LAST_ACK</code> 状态。</li><li>客户端发回一个带 <code>ACK,Seq</code> 的数据包到服务端，并进入 <code>TIME_WAIT</code> 状态。服务端收到数据包后关闭连接，客户端经过 2MSL 后未收到服务端再次发来的数据包则关闭连接。</li></ol><hr><p>参考资料：</p><ul><li><a href="https://juejin.im/post/6844904021308735502" target="_blank" rel="noopener noreferrer">(1.6w 字)浏览器灵魂之问，请问你能接得住几个？</a></li><li><a href="https://segmentfault.com/a/1190000006879700" target="_blank" rel="noopener noreferrer">前端经典面试题: 从输入 URL 到页面加载发生了什么？</a></li><li><a href="https://zhuanlan.zhihu.com/p/57895541" target="_blank" rel="noopener noreferrer">经典面试题：从 URL 输入到页面展现到底发生什么？</a></li><li><a href="https://github.com/kaola-fed/blog/issues/271" target="_blank" rel="noopener noreferrer">从输入页面地址到展示页面信息都发生了些什么？</a></li><li><a href="https://zhuanlan.zhihu.com/p/86426969" target="_blank" rel="noopener noreferrer">面试官，不要再问我三次握手和四次挥手</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/oxyzhg/fex/edit/main/docs/advanced/browser/from-url-to-page-load.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/fex/docs/advanced/vue/mvvm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« MVVM</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/fex/docs/advanced/browser/browser-storage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">浏览器存储 »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-dns-解析" class="table-of-contents__link">1. DNS 解析</a><ul><li><a href="#dns-解析过程" class="table-of-contents__link">DNS 解析过程</a></li><li><a href="#dns-优化" class="table-of-contents__link">DNS 优化</a></li><li><a href="#dns-负载均衡" class="table-of-contents__link">DNS 负载均衡</a></li></ul></li><li><a href="#2-tcp-连接" class="table-of-contents__link">2. TCP 连接</a><ul><li><a href="#三次握手" class="table-of-contents__link">三次握手</a></li></ul></li><li><a href="#3-发送-http-请求" class="table-of-contents__link">3. 发送 HTTP 请求</a><ul><li><a href="#请求报文" class="table-of-contents__link">请求报文</a></li><li><a href="#请求行" class="table-of-contents__link">请求行</a></li><li><a href="#请求头部" class="table-of-contents__link">请求头部</a></li><li><a href="#请求包体" class="table-of-contents__link">请求包体</a></li></ul></li><li><a href="#4服务端处理请求并返回-http-报文" class="table-of-contents__link">4.服务端处理请求并返回 HTTP 报文</a><ul><li><a href="#响应报文" class="table-of-contents__link">响应报文</a></li><li><a href="#响应行" class="table-of-contents__link">响应行</a></li></ul></li><li><a href="#5客户端解析并渲染页面" class="table-of-contents__link">5.客户端解析并渲染页面</a><ul><li><a href="#根据-html-解析生成-dom-树" class="table-of-contents__link">根据 HTML 解析生成 DOM 树</a></li><li><a href="#根据-css-解析生成-css-规则树" class="table-of-contents__link">根据 CSS 解析生成 CSS 规则树</a></li><li><a href="#生成渲染树" class="table-of-contents__link">生成渲染树</a></li><li><a href="#根据渲染树计算每一个节点的信息（布局）" class="table-of-contents__link">根据渲染树计算每一个节点的信息（布局）</a></li><li><a href="#根据计算好的信息绘制页面" class="table-of-contents__link">根据计算好的信息绘制页面</a></li></ul></li><li><a href="#6-断开连接" class="table-of-contents__link">6. 断开连接</a><ul><li><a href="#四次挥手" class="table-of-contents__link">四次挥手</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/fex/docs/advanced">前端进阶</a></li><li class="footer__item"><a class="footer__link-item" href="/fex/docs/engineering">前端工程化</a></li><li class="footer__item"><a class="footer__link-item" href="/fex/docs/algorithms">数据结构与算法</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://juejin.cn/user/571401775099528" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金</a></li><li class="footer__item"><a href="https://www.yuque.com/oxyzhg" target="_blank" rel="noopener noreferrer" class="footer__link-item">语雀</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/oxyzhg" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2021 Oxyzhg</div></div></div></footer></div>
<script src="/fex/styles.9c17d1f3.js"></script>
<script src="/fex/runtime~main.f4a5e530.js"></script>
<script src="/fex/main.f2bc5511.js"></script>
<script src="/fex/1.98595dda.js"></script>
<script src="/fex/2.0901b864.js"></script>
<script src="/fex/73.9ebeebc2.js"></script>
<script src="/fex/74.58203a54.js"></script>
<script src="/fex/935f2afb.65002741.js"></script>
<script src="/fex/17896441.c03a6b1c.js"></script>
<script src="/fex/fe7df52f.1deac101.js"></script>
</body>
</html>