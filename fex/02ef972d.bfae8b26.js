(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{63:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return a})),t.d(n,"metadata",(function(){return c})),t.d(n,"toc",(function(){return l})),t.d(n,"default",(function(){return p}));var o=t(3),r=t(7),i=(t(0),t(91)),a={id:"data-driven",title:"\u6570\u636e\u9a71\u52a8"},c={unversionedId:"advanced/vue/data-driven",id:"advanced/vue/data-driven",isDocsHomePage:!1,title:"\u6570\u636e\u9a71\u52a8",description:"new Vue \u53d1\u751f\u4e86\u4ec0\u4e48",source:"@site/docs/advanced/vue/data-driven.md",slug:"/advanced/vue/data-driven",permalink:"/fex/docs/advanced/vue/data-driven",editUrl:"https://github.com/oxyzhg/fex/edit/main/docs/advanced/vue/data-driven.md",version:"current",sidebar:"advanced",previous:{title:"\u6982\u89c8",permalink:"/fex/docs/advanced/vue/readme"},next:{title:"\u7ec4\u4ef6\u5316",permalink:"/fex/docs/advanced/vue/componentization"}},l=[{value:"new Vue \u53d1\u751f\u4e86\u4ec0\u4e48",id:"new-vue-\u53d1\u751f\u4e86\u4ec0\u4e48",children:[]},{value:"Vue \u5b9e\u4f8b\u6302\u8f7d",id:"vue-\u5b9e\u4f8b\u6302\u8f7d",children:[]},{value:"render",id:"render",children:[]}],s={toc:l};function p(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},s,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"new-vue-\u53d1\u751f\u4e86\u4ec0\u4e48"},"new Vue \u53d1\u751f\u4e86\u4ec0\u4e48"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/instance/index.js"',title:'"src/core/instance/index.js"'},"function Vue(options) {\n  if (process.env.NODE_ENV !== 'production' && !(this instanceof Vue)) {\n    warn('Vue is a constructor and should be called with the `new` keyword');\n  }\n  this._init(options);\n}\n")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/instance/init.js"',title:'"src/core/instance/init.js"'},"Vue.prototype._init = function (options?: Object) {\n  const vm: Component = this;\n  // a uid\n  vm._uid = uid++;\n\n  let startTag, endTag;\n  /* istanbul ignore if */\n  if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n    startTag = `vue-perf-start:${vm._uid}`;\n    endTag = `vue-perf-end:${vm._uid}`;\n    mark(startTag);\n  }\n\n  // a flag to avoid this being observed\n  vm._isVue = true;\n  // merge options\n  if (options && options._isComponent) {\n    // optimize internal component instantiation\n    // since dynamic options merging is pretty slow, and none of the\n    // internal component options needs special treatment.\n    initInternalComponent(vm, options);\n  } else {\n    vm.$options = mergeOptions(resolveConstructorOptions(vm.constructor), options || {}, vm);\n  }\n  /* istanbul ignore else */\n  if (process.env.NODE_ENV !== 'production') {\n    initProxy(vm);\n  } else {\n    vm._renderProxy = vm;\n  }\n  // expose real self\n  vm._self = vm;\n  initLifecycle(vm);\n  initEvents(vm);\n  initRender(vm);\n  callHook(vm, 'beforeCreate');\n  initInjections(vm); // resolve injections before data/props\n  initState(vm);\n  initProvide(vm); // resolve provide after data/props\n  callHook(vm, 'created');\n\n  /* istanbul ignore if */\n  if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n    vm._name = formatComponentName(vm, false);\n    mark(endTag);\n    measure(`vue ${vm._name} init`, startTag, endTag);\n  }\n\n  if (vm.$options.el) {\n    vm.$mount(vm.$options.el);\n  }\n};\n")),Object(i.b)("p",null,"Vue \u521d\u59cb\u5316\u4e3b\u8981\u5c31\u5e72\u4e86\u51e0\u4ef6\u4e8b\u60c5\uff1a\u5408\u5e76\u914d\u7f6e\uff0c\u521d\u59cb\u5316\u751f\u547d\u5468\u671f\uff0c\u521d\u59cb\u5316\u4e8b\u4ef6\u4e2d\u5fc3\uff0c\u521d\u59cb\u5316\u6e32\u67d3\uff0c\u521d\u59cb\u5316 data\u3001props\u3001computed\u3001watcher \u7b49\u3002"),Object(i.b)("h2",{id:"vue-\u5b9e\u4f8b\u6302\u8f7d"},"Vue \u5b9e\u4f8b\u6302\u8f7d"),Object(i.b)("p",null,"Vue \u4e2d\u6211\u4eec\u662f\u901a\u8fc7 $mount \u5b9e\u4f8b\u65b9\u6cd5\u53bb\u6302\u8f7d vm \u7684\uff0c\u7531\u4e8e\u865a\u62df DOM \u7f16\u8bd1\u540e\u53ef\u4ee5\u5728\u4e0d\u540c\u5e73\u53f0\u8fd0\u884c\uff0c\u56e0\u6b64\u8fd9\u4e2a\u65b9\u6cd5\u5728\u4e0d\u540c\u5e73\u53f0\u6709\u4e0d\u540c\u7684\u5b9a\u4e49\u3002\u6211\u4eec\u6765\u770b\u6700\u5e38\u7528\u7684\u5b9a\u4e49\uff1a"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/platform/web/entry-runtime-with-compiler.js"',title:'"src/platform/web/entry-runtime-with-compiler.js"'},"const mount = Vue.prototype.$mount;\nVue.prototype.$mount = function (el?: string | Element, hydrating?: boolean): Component {\n  el = el && query(el);\n\n  /* istanbul ignore if */\n  if (el === document.body || el === document.documentElement) {\n    process.env.NODE_ENV !== 'production' &&\n      warn(`Do not mount Vue to <html> or <body> - mount to normal elements instead.`);\n    return this;\n  }\n\n  const options = this.$options;\n  // resolve template/el and convert to render function\n  if (!options.render) {\n    let template = options.template;\n    if (template) {\n      if (typeof template === 'string') {\n        if (template.charAt(0) === '#') {\n          template = idToTemplate(template);\n          /* istanbul ignore if */\n          if (process.env.NODE_ENV !== 'production' && !template) {\n            warn(`Template element not found or is empty: ${options.template}`, this);\n          }\n        }\n      } else if (template.nodeType) {\n        template = template.innerHTML;\n      } else {\n        if (process.env.NODE_ENV !== 'production') {\n          warn('invalid template option:' + template, this);\n        }\n        return this;\n      }\n    } else if (el) {\n      template = getOuterHTML(el);\n    }\n    if (template) {\n      /* istanbul ignore if */\n      if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n        mark('compile');\n      }\n\n      const { render, staticRenderFns } = compileToFunctions(\n        template,\n        {\n          shouldDecodeNewlines,\n          shouldDecodeNewlinesForHref,\n          delimiters: options.delimiters,\n          comments: options.comments,\n        },\n        this\n      );\n      options.render = render;\n      options.staticRenderFns = staticRenderFns;\n\n      /* istanbul ignore if */\n      if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n        mark('compile end');\n        measure(`vue ${this._name} compile`, 'compile', 'compile end');\n      }\n    }\n  }\n  return mount.call(this, el, hydrating);\n};\n")),Object(i.b)("p",null,"\u8fd9\u6bb5\u4ee3\u7801\u7f13\u5b58\u4e86\u539f\u578b\u4e0a\u7684 ",Object(i.b)("inlineCode",{parentName:"p"},"$mount")," \u65b9\u6cd5\uff0c\u518d\u91cd\u65b0\u5b9a\u4e49\u8be5\u65b9\u6cd5\u3002\u5173\u952e\u7684\u903b\u8f91\u662f\uff0c\u5982\u679c\u6ca1\u6709\u5b9a\u4e49 render \u65b9\u6cd5\uff0c\u5219\u4f1a\u628a el/template \u5b57\u7b26\u4e32\u8f6c\u6362\u6210 render \u65b9\u6cd5\u3002\u6700\u540e\u8c03\u7528\u539f\u578b\u4e0a ",Object(i.b)("inlineCode",{parentName:"p"},"$mount")," \u65b9\u6cd5\u6302\u8f7d\u3002"),Object(i.b)("p",null,"\u539f\u578b\u4e0a\u7684 ",Object(i.b)("inlineCode",{parentName:"p"},"$mount")," \u65b9\u6cd5\u5b9a\u4e49\uff1a"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/platform/web/runtime/index.js"',title:'"src/platform/web/runtime/index.js"'},"// public mount method\nVue.prototype.$mount = function (el?: string | Element, hydrating?: boolean): Component {\n  el = el && inBrowser ? query(el) : undefined;\n  return mountComponent(this, el, hydrating);\n};\n")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"$mount")," \u65b9\u6cd5\u6700\u7ec8\u4f1a\u8c03\u7814 ",Object(i.b)("inlineCode",{parentName:"p"},"mountComponent")," \u65b9\u6cd5\uff1a"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/instance/lifecycle.js"',title:'"src/core/instance/lifecycle.js"'},"export function mountComponent(vm: Component, el: ?Element, hydrating?: boolean): Component {\n  vm.$el = el;\n  if (!vm.$options.render) {\n    vm.$options.render = createEmptyVNode;\n    // ...\n  }\n  callHook(vm, 'beforeMount');\n\n  let updateComponent = () => {\n    vm._update(vm._render(), hydrating);\n  };\n\n  // we set this to vm._watcher inside the watcher's constructor\n  // since the watcher's initial patch may call $forceUpdate (e.g. inside child\n  // component's mounted hook), which relies on vm._watcher being already defined\n  new Watcher(\n    vm,\n    updateComponent,\n    noop,\n    {\n      before() {\n        if (vm._isMounted) {\n          callHook(vm, 'beforeUpdate');\n        }\n      },\n    },\n    true /* isRenderWatcher */\n  );\n  hydrating = false;\n\n  // manually mounted instance, call mounted on self\n  // mounted is called for render-created child components in its inserted hook\n  if (vm.$vnode == null) {\n    vm._isMounted = true;\n    callHook(vm, 'mounted');\n  }\n  return vm;\n}\n")),Object(i.b)("p",null,"\u5b9e\u9645\u4e0a\uff0c\u6267\u884c\u5230\u8fd9\u4e2a\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u751f\u547d\u5468\u671f\u5df2\u7ecf\u6765\u5230 Mount \u9636\u6bb5\u3002",Object(i.b)("inlineCode",{parentName:"p"},"mountComponent")," \u6838\u5fc3\u5c31\u662f\u5148\u5b9e\u4f8b\u5316\u4e00\u4e2a\u6e32\u67d3 ",Object(i.b)("inlineCode",{parentName:"p"},"Watcher"),"\uff0c\u5728\u5b83\u7684\u56de\u8c03\u51fd\u6570\u4e2d\u4f1a\u8c03\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"updateComponent")," \u65b9\u6cd5\uff0c\u5728\u6b64\u65b9\u6cd5\u4e2d\u8c03\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"vm._render")," \u65b9\u6cd5\u5148\u751f\u6210\u865a\u62df Node\uff0c\u6700\u7ec8\u8c03\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"vm._update")," \u66f4\u65b0 DOM\u3002"),Object(i.b)("h2",{id:"render"},"render"))}p.isMDXComponent=!0},91:function(e,n,t){"use strict";t.d(n,"a",(function(){return m})),t.d(n,"b",(function(){return v}));var o=t(0),r=t.n(o);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=r.a.createContext({}),p=function(e){var n=r.a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},m=function(e){var n=p(e.components);return r.a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},u=r.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,a=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=p(t),u=o,v=m["".concat(a,".").concat(u)]||m[u]||d[u]||i;return t?r.a.createElement(v,c(c({ref:n},s),{},{components:t})):r.a.createElement(v,c({ref:n},s))}));function v(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,a=new Array(i);a[0]=u;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c.mdxType="string"==typeof e?e:o,a[1]=c;for(var s=2;s<i;s++)a[s]=t[s];return r.a.createElement.apply(null,a)}return r.a.createElement.apply(null,t)}u.displayName="MDXCreateElement"}}]);