(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{110:function(e,n,t){"use strict";t.d(n,"a",(function(){return l})),t.d(n,"b",(function(){return b}));var o=t(0),a=t.n(o);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=a.a.createContext({}),d=function(e){var n=a.a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},l=function(e){var n=d(e.components);return a.a.createElement(p.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},u=a.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,r=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),l=d(t),u=o,b=l["".concat(r,".").concat(u)]||l[u]||m[u]||i;return t?a.a.createElement(b,c(c({ref:n},p),{},{components:t})):a.a.createElement(b,c({ref:n},p))}));function b(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,r=new Array(i);r[0]=u;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c.mdxType="string"==typeof e?e:o,r[1]=c;for(var p=2;p<i;p++)r[p]=t[p];return a.a.createElement.apply(null,r)}return a.a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},97:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return r})),t.d(n,"metadata",(function(){return c})),t.d(n,"toc",(function(){return s})),t.d(n,"default",(function(){return d}));var o=t(3),a=t(7),i=(t(0),t(110)),r={id:"componentization",title:"\u7ec4\u4ef6\u5316"},c={unversionedId:"advanced/vue/componentization",id:"advanced/vue/componentization",isDocsHomePage:!1,title:"\u7ec4\u4ef6\u5316",description:"Vue.js \u53e6\u4e00\u4e2a\u6838\u5fc3\u601d\u60f3\u662f\u7ec4\u4ef6\u5316\u3002\u6240\u8c13\u7ec4\u4ef6\u5316\uff0c\u5c31\u662f\u628a\u9875\u9762\u62c6\u5206\u6210\u591a\u4e2a\u7ec4\u4ef6 (component)\uff0c\u6bcf\u4e2a\u7ec4\u4ef6\u4f9d\u8d56\u7684 CSS\u3001JavaScript\u3001\u6a21\u677f\u3001\u56fe\u7247\u7b49\u8d44\u6e90\u653e\u5728\u4e00\u8d77\u5f00\u53d1\u548c\u7ef4\u62a4\u3002\u7ec4\u4ef6\u662f\u8d44\u6e90\u72ec\u7acb\u7684\uff0c\u7ec4\u4ef6\u5728\u7cfb\u7edf\u5185\u90e8\u53ef\u590d\u7528\uff0c\u7ec4\u4ef6\u548c\u7ec4\u4ef6\u4e4b\u95f4\u53ef\u4ee5\u5d4c\u5957\u3002",source:"@site/docs/advanced/vue/componentization.md",slug:"/advanced/vue/componentization",permalink:"/fex/docs/advanced/vue/componentization",editUrl:"https://github.com/oxyzhg/fex/edit/main/docs/advanced/vue/componentization.md",version:"current",sidebar:"advanced",previous:{title:"\u6570\u636e\u9a71\u52a8",permalink:"/fex/docs/advanced/vue/data-driven"},next:{title:"\u54cd\u5e94\u5f0f\u539f\u7406",permalink:"/fex/docs/advanced/vue/reactive"}},s=[{value:"createComponent",id:"createcomponent",children:[{value:"\u6784\u9020\u5b50\u7c7b\u6784\u9020\u51fd\u6570",id:"\u6784\u9020\u5b50\u7c7b\u6784\u9020\u51fd\u6570",children:[]},{value:"\u5b89\u88c5\u7ec4\u4ef6\u94a9\u5b50\u51fd\u6570",id:"\u5b89\u88c5\u7ec4\u4ef6\u94a9\u5b50\u51fd\u6570",children:[]},{value:"\u5b9e\u4f8b\u5316 VNode",id:"\u5b9e\u4f8b\u5316-vnode",children:[]}]},{value:"patch",id:"patch",children:[{value:"createComponent",id:"createcomponent-1",children:[]}]}],p={toc:s};function d(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Vue.js \u53e6\u4e00\u4e2a\u6838\u5fc3\u601d\u60f3\u662f\u7ec4\u4ef6\u5316\u3002\u6240\u8c13\u7ec4\u4ef6\u5316\uff0c\u5c31\u662f\u628a\u9875\u9762\u62c6\u5206\u6210\u591a\u4e2a\u7ec4\u4ef6 (component)\uff0c\u6bcf\u4e2a\u7ec4\u4ef6\u4f9d\u8d56\u7684 CSS\u3001JavaScript\u3001\u6a21\u677f\u3001\u56fe\u7247\u7b49\u8d44\u6e90\u653e\u5728\u4e00\u8d77\u5f00\u53d1\u548c\u7ef4\u62a4\u3002\u7ec4\u4ef6\u662f\u8d44\u6e90\u72ec\u7acb\u7684\uff0c\u7ec4\u4ef6\u5728\u7cfb\u7edf\u5185\u90e8\u53ef\u590d\u7528\uff0c\u7ec4\u4ef6\u548c\u7ec4\u4ef6\u4e4b\u95f4\u53ef\u4ee5\u5d4c\u5957\u3002"),Object(i.b)("h2",{id:"createcomponent"},"createComponent"),Object(i.b)("p",null,"\u5728\u6570\u636e\u9a71\u52a8\u4e00\u8282\u5206\u6790 ",Object(i.b)("inlineCode",{parentName:"p"},"_createElement")," \u65b9\u6cd5\u65f6\u8bf4\u5230\uff0c\u5982\u679c tag \u662f\u666e\u901a html \u6807\u7b7e\uff0c\u5c31\u5b9e\u4f8b\u5316\u4e00\u4e2a\u666e\u901a VNode\uff0c\u5426\u5219\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"p"},"createComponent")," \u65b9\u6cd5\u521b\u5efa\u4e00\u4e2a\u7ec4\u4ef6 VNode\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/vdom/create-component.js"',title:'"src/core/vdom/create-component.js"'},"export function createComponent(\n  Ctor: Class<Component> | Function | Object | void,\n  data: ?VNodeData,\n  context: Component,\n  children: ?Array<VNode>,\n  tag?: string\n): VNode | Array<VNode> | void {\n  if (isUndef(Ctor)) {\n    return;\n  }\n\n  // highlight-start\n  const baseCtor = context.$options._base;\n  // plain options object: turn it into a constructor\n  if (isObject(Ctor)) {\n    Ctor = baseCtor.extend(Ctor);\n  }\n  // highlight-end\n\n  // if at this stage it's not a constructor or an async component factory,\n  // reject.\n  if (typeof Ctor !== 'function') {\n    // ...\n    return;\n  }\n\n  // async component\n  let asyncFactory;\n  if (isUndef(Ctor.cid)) {\n    asyncFactory = Ctor;\n    Ctor = resolveAsyncComponent(asyncFactory, baseCtor, context);\n    if (Ctor === undefined) {\n      // return a placeholder node for async component, which is rendered\n      // as a comment node but preserves all the raw information for the node.\n      // the information will be used for async server-rendering and hydration.\n      return createAsyncPlaceholder(asyncFactory, data, context, children, tag);\n    }\n  }\n\n  data = data || {};\n\n  // resolve constructor options in case global mixins are applied after\n  // component constructor creation\n  resolveConstructorOptions(Ctor);\n\n  // transform component v-model data into props & events\n  if (isDef(data.model)) {\n    transformModel(Ctor.options, data);\n  }\n\n  // extract props\n  const propsData = extractPropsFromVNodeData(data, Ctor, tag);\n\n  // functional component\n  if (isTrue(Ctor.options.functional)) {\n    return createFunctionalComponent(Ctor, propsData, data, context, children);\n  }\n\n  // extract listeners, since these needs to be treated as\n  // child component listeners instead of DOM listeners\n  const listeners = data.on;\n  // replace with listeners with .native modifier\n  // so it gets processed during parent component patch.\n  data.on = data.nativeOn;\n\n  if (isTrue(Ctor.options.abstract)) {\n    // abstract components do not keep anything\n    // other than props & listeners & slot\n\n    // work around flow\n    const slot = data.slot;\n    data = {};\n    if (slot) {\n      data.slot = slot;\n    }\n  }\n\n  // install component management hooks onto the placeholder node\n  // highlight-next-line\n  installComponentHooks(data);\n\n  // return a placeholder vnode\n  const name = Ctor.options.name || tag;\n  // highlight-start\n  const vnode = new VNode(\n    `vue-component-${Ctor.cid}${name ? `-${name}` : ''}`,\n    data,\n    undefined,\n    undefined,\n    undefined,\n    context,\n    { Ctor, propsData, listeners, tag, children },\n    asyncFactory\n  );\n  // highlight-end\n\n  // ...\n  return vnode;\n}\n")),Object(i.b)("p",null,"\u5b83\u7684\u4f5c\u7528\u662f\u521b\u5efa\u7ec4\u4ef6\u7c7b\u578b\u7684 VNode\uff0c\u4e3b\u8981\u5c31 3 \u4e2a\u5173\u952e\u6b65\u9aa4\uff1a\u6784\u9020\u5b50\u7c7b\u6784\u9020\u51fd\u6570\u3001\u5b89\u88c5\u7ec4\u4ef6\u94a9\u5b50\u51fd\u6570\u3001\u5b9e\u4f8b\u5316 VNode\u3002"),Object(i.b)("h3",{id:"\u6784\u9020\u5b50\u7c7b\u6784\u9020\u51fd\u6570"},"\u6784\u9020\u5b50\u7c7b\u6784\u9020\u51fd\u6570"),Object(i.b)("p",null,"\u5b9e\u9645\u4e0a\uff0c\u4ee3\u7801\u4e2d ",Object(i.b)("inlineCode",{parentName:"p"},"baseCtor")," \u5c31\u662f ",Object(i.b)("inlineCode",{parentName:"p"},"Vue"),"\uff0c\u8fd9\u5728\u521d\u59cb\u5316\u9636\u6bb5\u5c31\u6709\u5b9a\u4e49\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/global-api/index.js"',title:'"src/core/global-api/index.js"'},'export function initGlobalAPI(Vue: GlobalAPI) {\n  // this is used to identify the "base" constructor to extend all plain-object\n  // components with in Weex\'s multi-instance scenarios.\n  // highlight-next-line\n  Vue.options._base = Vue;\n}\n')),Object(i.b)("p",null,"\u7136\u540e\u6211\u4eec\u770b\u4e00\u4e0b ",Object(i.b)("inlineCode",{parentName:"p"},"Vue.extend")," \u51fd\u6570\u7684\u5b9a\u4e49\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/global-api/extend.js"',title:'"src/core/global-api/extend.js"'},"/**\n * Class inheritance\n */\nVue.extend = function (extendOptions: Object): Function {\n  extendOptions = extendOptions || {};\n  const Super = this;\n  const SuperId = Super.cid;\n  // highlight-start\n  const cachedCtors = extendOptions._Ctor || (extendOptions._Ctor = {});\n  if (cachedCtors[SuperId]) {\n    return cachedCtors[SuperId];\n  }\n  // highlight-end\n\n  const name = extendOptions.name || Super.options.name;\n  if (process.env.NODE_ENV !== 'production' && name) {\n    validateComponentName(name);\n  }\n\n  const Sub = function VueComponent(options) {\n    // highlight-next-line\n    this._init(options);\n  };\n  // highlight-start\n  Sub.prototype = Object.create(Super.prototype);\n  Sub.prototype.constructor = Sub;\n  // highlight-end\n  Sub.cid = cid++;\n  Sub.options = mergeOptions(Super.options, extendOptions);\n  Sub['super'] = Super;\n\n  // For props and computed properties, we define the proxy getters on\n  // the Vue instances at extension time, on the extended prototype. This\n  // avoids Object.defineProperty calls for each instance created.\n  if (Sub.options.props) {\n    initProps(Sub);\n  }\n  if (Sub.options.computed) {\n    initComputed(Sub);\n  }\n\n  // allow further extension/mixin/plugin usage\n  Sub.extend = Super.extend;\n  Sub.mixin = Super.mixin;\n  Sub.use = Super.use;\n\n  // create asset registers, so extended classes\n  // can have their private assets too.\n  ASSET_TYPES.forEach(function (type) {\n    Sub[type] = Super[type];\n  });\n  // enable recursive self-lookup\n  if (name) {\n    Sub.options.components[name] = Sub;\n  }\n\n  // keep a reference to the super options at extension time.\n  // later at instantiation we can check if Super's options have\n  // been updated.\n  Sub.superOptions = Super.options;\n  Sub.extendOptions = extendOptions;\n  Sub.sealedOptions = extend({}, Sub.options);\n\n  // cache constructor\n  cachedCtors[SuperId] = Sub;\n  return Sub;\n};\n")),Object(i.b)("p",null,"\u8fd9\u662f\u4e00\u79cd\u975e\u5e38\u7ecf\u5178\u7684\u539f\u578b\u7ee7\u627f\u7684\u65b9\u5f0f\uff0c\u53ea\u4e0d\u8fc7\u5728\u7ee7\u627f\u540e\u62d3\u5c55\u4e86\u4e00\u4e9b\u5c5e\u6027\u65b9\u6cd5\uff0c\u7136\u540e\u7f13\u5b58\u4e86\u8fd9\u4e2a\u6784\u9020\u51fd\u6570\u3002"),Object(i.b)("div",{className:"admonition admonition-important alert alert--info"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"important")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"\u5b9e\u9645\u4e0a Vue.js \u5efa\u8bae data \u4f7f\u7528\u51fd\u6570\u800c\u4e0d\u662f\u76f4\u63a5\u4f7f\u7528\u5bf9\u8c61\uff0c\u5c31\u8ddf\u8fd9\u4e2a\u7f13\u5b58\u7684\u6784\u9020\u51fd\u6570\u6709\u5173\u7cfb\u3002\u8bd5\u60f3\u540c\u4e00\u4e2a\u7ec4\u4ef6\u6784\u9020\u51fd\u6570\u53ea\u4f1a\u88ab\u521b\u5efa\u4e00\u6b21\uff0c\u5728\u7b2c\u4e00\u6b21\u6784\u9020\u65f6 data \u5bf9\u5e94\u7684\u72b6\u6001\u5c31\u5df2\u7ecf\u4ea7\u751f\u4e86\uff0c\u7531\u4e8e\u5bf9\u8c61\u7c7b\u578b\u7684\u6570\u636e\u662f\u5730\u5740\u5f15\u7528\uff0c\u90a3\u4e48\u590d\u7528\u7684\u6784\u9020\u51fd\u6570\u4e2d data \u5c5e\u6027\u5fc5\u7136\u4f1a\u6307\u5411\u540c\u4e00\u5904\u5f15\u7528\u3002"))),Object(i.b)("h3",{id:"\u5b89\u88c5\u7ec4\u4ef6\u94a9\u5b50\u51fd\u6570"},"\u5b89\u88c5\u7ec4\u4ef6\u94a9\u5b50\u51fd\u6570"),Object(i.b)("p",null,"\u6211\u4eec\u4e4b\u524d\u63d0\u5230 Vue.js \u4f7f\u7528\u7684 Virtual DOM \u53c2\u8003\u7684\u662f\u5f00\u6e90\u5e93 snabbdom \uff0c\u5b83\u7684\u4e00\u4e2a\u7279\u70b9\u662f\u5728 VNode \u7684 patch \u6d41\u7a0b\u4e2d\u5bf9\u5916\u66b4\u9732\u4e86\u5404\u79cd\u65f6\u673a\u7684\u94a9\u5b50\u51fd\u6570\uff0c\u65b9\u4fbf\u6211\u4eec\u505a\u4e00\u4e9b\u989d\u5916\u7684\u4e8b\u60c5\uff0cVue.js \u4e5f\u662f\u5145\u5206\u5229\u7528\u8fd9\u4e00\u70b9\uff0c\u5728\u521d\u59cb\u5316\u4e00\u4e2a Component \u7c7b\u578b\u7684 VNode \u7684\u8fc7\u7a0b\u4e2d\u5b9e\u73b0\u4e86\u51e0\u4e2a\u94a9\u5b50\u51fd\u6570\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/vdom/create-component.js"',title:'"src/core/vdom/create-component.js"'},"function installComponentHooks(data: VNodeData) {\n  const hooks = data.hook || (data.hook = {});\n  for (let i = 0; i < hooksToMerge.length; i++) {\n    const key = hooksToMerge[i];\n    const existing = hooks[key];\n    const toMerge = componentVNodeHooks[key];\n    if (existing !== toMerge && !(existing && existing._merged)) {\n      hooks[key] = existing ? mergeHook(toMerge, existing) : toMerge;\n    }\n  }\n}\n")),Object(i.b)("p",null,"\u6574\u4e2a ",Object(i.b)("inlineCode",{parentName:"p"},"installComponentHooks")," \u7684\u8fc7\u7a0b\u5c31\u662f\u628a ",Object(i.b)("inlineCode",{parentName:"p"},"componentVNodeHooks")," \u7684\u94a9\u5b50\u51fd\u6570\u5408\u5e76\u5230 ",Object(i.b)("inlineCode",{parentName:"p"},"data.hook")," \u4e2d\uff0c\u5728 VNode \u6267\u884c patch \u7684\u8fc7\u7a0b\u4e2d\u6267\u884c\u76f8\u5173\u7684\u94a9\u5b50\u51fd\u6570\u3002\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\u5408\u5e76\u7b56\u7565\uff0c\u5728\u5408\u5e76\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u67d0\u4e2a\u65f6\u673a\u7684\u94a9\u5b50\u5df2\u7ecf\u5b58\u5728 ",Object(i.b)("inlineCode",{parentName:"p"},"data.hook")," \u4e2d\uff0c\u90a3\u5408\u5e76\u540e\u6700\u7ec8\u6267\u884c\u7684\u65f6\u5019\uff0c\u4f9d\u6b21\u6267\u884c\u8fd9\u4e24\u4e2a\u94a9\u5b50\u51fd\u6570\u5373\u53ef\u3002"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"componentVNodeHooks")," \u5305\u542b\u7684\u94a9\u5b50\u51fd\u6570\u6709\uff1a",Object(i.b)("inlineCode",{parentName:"p"},"init"),"\u3001",Object(i.b)("inlineCode",{parentName:"p"},"prepatch"),"\u3001",Object(i.b)("inlineCode",{parentName:"p"},"insert"),"\u3001",Object(i.b)("inlineCode",{parentName:"p"},"destroy"),"\u3002"),Object(i.b)("h3",{id:"\u5b9e\u4f8b\u5316-vnode"},"\u5b9e\u4f8b\u5316 VNode"),Object(i.b)("p",null,"\u6700\u540e\u4e00\u6b65\u975e\u5e38\u7b80\u5355\uff0c\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"p"},"new VNode")," \u5b9e\u4f8b\u5316\u4e00\u4e2a ",Object(i.b)("inlineCode",{parentName:"p"},"vnode")," \u5e76\u8fd4\u56de\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u548c\u666e\u901a\u5143\u7d20\u8282\u70b9\u7684 ",Object(i.b)("inlineCode",{parentName:"p"},"vnode")," \u4e0d\u540c\uff0c\u7ec4\u4ef6\u7684 ",Object(i.b)("inlineCode",{parentName:"p"},"vnode")," \u662f\u6ca1\u6709 ",Object(i.b)("inlineCode",{parentName:"p"},"children")," \u7684\uff0c\u8fd9\u70b9\u5f88\u5173\u952e\u3002"),Object(i.b)("h2",{id:"patch"},"patch"),Object(i.b)("p",null,"\u524d\u9762\u8bf4\u5230\uff0c\u5728\u6267\u884c ",Object(i.b)("inlineCode",{parentName:"p"},"createElm")," \u521b\u5efa\u771f\u5b9e\u8282\u70b9\u65f6\uff0c\u4f1a\u5148\u5c1d\u8bd5\u6267\u884c ",Object(i.b)("inlineCode",{parentName:"p"},"createComponent")," \u521b\u5efa\u5b50\u7ec4\u4ef6\uff0c\u5426\u5219\u6267\u884c ",Object(i.b)("inlineCode",{parentName:"p"},"createChildren")," \u9012\u5f52\u521b\u5efa\u666e\u901a VNode\u3002"),Object(i.b)("h3",{id:"createcomponent-1"},"createComponent"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/vdom/patch.js"',title:'"src/core/vdom/patch.js"'},"function createComponent(vnode, insertedVnodeQueue, parentElm, refElm) {\n  let i = vnode.data;\n  if (isDef(i)) {\n    const isReactivated = isDef(vnode.componentInstance) && i.keepAlive;\n    // highlight-start\n    if (isDef((i = i.hook)) && isDef((i = i.init))) {\n      i(vnode, false /* hydrating */);\n    }\n    // highlight-end\n    // after calling the init hook, if the vnode is a child component\n    // it should've created a child instance and mounted it. the child\n    // component also has set the placeholder vnode's elm.\n    // in that case we can just return the element and be done.\n    if (isDef(vnode.componentInstance)) {\n      initComponent(vnode, insertedVnodeQueue);\n      insert(parentElm, vnode.elm, refElm);\n      if (isTrue(isReactivated)) {\n        reactivateComponent(vnode, insertedVnodeQueue, parentElm, refElm);\n      }\n      return true;\n    }\n  }\n}\n")),Object(i.b)("p",null,"\u8fd9\u91cc\u9996\u5148\u5bf9 ",Object(i.b)("inlineCode",{parentName:"p"},"vnode.data")," \u4f5c\u4e86\u4e00\u4e9b\u5224\u65ad\uff0c\u5982\u679c ",Object(i.b)("inlineCode",{parentName:"p"},"vnode")," \u662f\u4e00\u4e2a\u7ec4\u4ef6 VNode\uff0c\u5224\u65ad\u540e\u5f97\u5230\u7684 ",Object(i.b)("inlineCode",{parentName:"p"},"i")," \u5c31\u662f ",Object(i.b)("inlineCode",{parentName:"p"},"init")," \u94a9\u5b50\u51fd\u6570\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/vdom/create-component.js"',title:'"src/core/vdom/create-component.js"'},"const componentVNodeHooks = {\n  init(vnode: VNodeWithData, hydrating: boolean): ?boolean {\n    if (vnode.componentInstance && !vnode.componentInstance._isDestroyed && vnode.data.keepAlive) {\n      // kept-alive components, treat as a patch\n      const mountedNode: any = vnode; // work around flow\n      componentVNodeHooks.prepatch(mountedNode, mountedNode);\n    } else {\n      // highlight-start\n      const child = (vnode.componentInstance = createComponentInstanceForVnode(\n        vnode,\n        activeInstance\n      ));\n      child.$mount(hydrating ? vnode.elm : undefined, hydrating);\n      // highlight-end\n    }\n  },\n  prepatch(oldVnode: MountedComponentVNode, vnode: MountedComponentVNode) {},\n  insert(vnode: MountedComponentVNode) {},\n  destroy(vnode: MountedComponentVNode) {},\n};\n")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"init")," \u94a9\u5b50\u51fd\u6570\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"p"},"createComponentInstanceForVnode")," \u521b\u5efa\u4e00\u4e2a Vue \u7684\u5b9e\u4f8b\uff0c\u7136\u540e\u8c03\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"$mount")," \u65b9\u6cd5\u6302\u8f7d\u5b50\u7ec4\u4ef6\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js",metastring:'title="src/core/vdom/create-component.js"',title:'"src/core/vdom/create-component.js"'},"export function createComponentInstanceForVnode(\n  vnode: any, // we know it's MountedComponentVNode but flow doesn't\n  parent: any // activeInstance in lifecycle state\n): Component {\n  const options: InternalComponentOptions = {\n    _isComponent: true,\n    _parentVnode: vnode,\n    parent,\n  };\n  // check inline-template render functions\n  const inlineTemplate = vnode.data.inlineTemplate;\n  if (isDef(inlineTemplate)) {\n    options.render = inlineTemplate.render;\n    options.staticRenderFns = inlineTemplate.staticRenderFns;\n  }\n  // highlight-next-line\n  return new vnode.componentOptions.Ctor(options);\n}\n")),Object(i.b)("p",null,"\u6240\u4ee5\u5b50\u7ec4\u4ef6\u7684\u5b9e\u4f8b\u5316\u5b9e\u9645\u4e0a\u5c31\u662f\u5728\u8fd9\u4e2a\u65f6\u673a\u6267\u884c\u7684\uff0c\u5e76\u4e14\u5b83\u4f1a\u6267\u884c\u5b9e\u4f8b\u7684 ",Object(i.b)("inlineCode",{parentName:"p"},"_init")," \u65b9\u6cd5\u3002"))}d.isMDXComponent=!0}}]);